import{_ as b,o as a,c as r,a as m,b as s,w as p,v as w,F as y,r as g,t as d,n as x,h as D,d as v,e as f,f as V,g as $,i as L,j as M}from"./index.49246efe.js";import{f as h,s as C}from"./vue3-datepicker.esm.82138076.js";const H={data(){return{filter:""}},props:{results:Object,loading:{type:Boolean,default:!0},error:{type:Boolean,default:!1}},computed:{filteredResults(){const i={};return this.results&&typeof this.results=="object"&&Object.keys(this.results).forEach(t=>{const l=this.results[t].filter(n=>this.filter?n.artist.includes(this.filter)||n.title.includes(this.filter):!0);i[t]=l}),i}},methods:{formatDate:h}},R={class:"card-list"},j={key:0,class:"is-flex is-justify-content-center is-align-items-center my-6"},S=s("div",{class:"loader"},null,-1),B=[S],E={key:1,class:"is-flex is-justify-content-center is-align-items-center my-6"},U=s("p",{class:"is-error"}," Sorry there was an error. You may find more details in your Javascript console, or in Showergel's logs ",-1),z=[U],F={key:2,class:"list-container"},N={class:"field"},P=s("label",{class:"label",for:"filter"},"Filter by artist or song name",-1),T={class:"control"},O={class:"subtitle is-3 day has-background-link has-text-light p-2 has-text-centered"},J={class:"titles"},Y={class:"media-left"},q={class:"block pt-1"},A={class:"media-content columns"},G={class:"content column"},I={class:"mb-0"},K={class:"small-caps subtitle is-4 is-capitalized"},Q={class:"is-size-5 has-text-grey is-italic mb-0"},W={class:"has-text-grey mb-0"},X={class:"content column"},Z={class:"tag is-warning"},ss={class:"pt-2 is-size-6 has-text-grey"},ts=s("div",{class:"media-right"},null,-1);function es(i,t,l,n,e,c){return a(),r("div",R,[l.loading?(a(),r("div",j,B)):m("",!0),!l.loading&&l.error?(a(),r("div",E,z)):m("",!0),!l.loading&&!l.error?(a(),r("div",F,[s("div",N,[P,s("div",T,[p(s("input",{id:"filter",class:"input",type:"text","onUpdate:modelValue":t[0]||(t[0]=_=>e.filter=_)},null,512),[[w,e.filter]])])]),(a(!0),r(y,null,g(c.filteredResults,(_,u)=>(a(),r("div",{key:u},[s("p",O,d(u),1),s("div",J,[(a(!0),r(y,null,g(_,(o,k)=>(a(),r("div",{key:o.on_air,class:x(`media mt-0 px-4 ${k%2===0?"has-background-light":""}`)},[s("div",Y,[s("div",q,d(c.formatDate(new Date(o.on_air),"HH:mm:ss")),1)]),s("div",A,[s("div",G,[s("p",I,[s("strong",K,d(o.artist),1)]),s("p",Q,d(o.title),1),s("p",W,d(o.album)+" - "+d(o.year),1)]),s("div",X,[s("div",Z,d(o.source),1),s("p",ss,d(o.initial_uri),1)])]),ts],2))),128))])]))),128))])):m("",!0)])}var os=b(H,[["render",es]]);const is={components:{CardList:os,Datepicker:C},data(){return{start:"",end:"",limit:"10",chronological:"",results:null,isLoading:!0,isError:!1}},methods:{getHistory(){this.isLoading=!0,this.isError=!1;let i=new URLSearchParams;this.limit&&i.append("limit",this.limit),this.start&&i.append("start",h(new Date(this.start),"yyyy-MM-dd")),this.end&&i.append("end",h(new Date(this.end),"yyyy-MM-dd")),this.chronological&&i.append("chronological",this.chronological),D.get("/metadata_log",{params:i}).then(this.onResults).catch(t=>{this.isError=!0,console.log(t)})},onResults(i){const l=i.data.metadata_log.reduce((n,e)=>{const c=h(new Date(e.on_air),"dd/MM/yyyy");return n[c]?n[c].push(e):n[c]=[e],n},{});this.results=l,this.isLoading=!1}},mounted(){this.getHistory()}},ls={id:"playout_history",class:"content my-4"},ns=s("h1",null,"Playout History",-1),as={class:"columns"},rs={class:"field column"},cs=s("label",{class:"label",for:"start"},"From",-1),ds={class:"control"},_s={class:"field column"},us=s("label",{class:"label",for:"end"},"To",-1),hs={class:"control"},ms={class:"is-flex is-justify-content-space-between"},fs={class:"field"},ps=s("label",{class:"label",for:"limit"},"Max. results:",-1),ys={class:"control"},gs={class:"select"},vs=s("option",null,"10",-1),bs=s("option",null,"100",-1),xs=s("option",null,"1000",-1),ks=[vs,bs,xs],ws={class:"field is-flex is-align-self-flex-end"},Ds={class:"checkbox",for:"chronological"},Vs={class:"field is-align-self-flex-end"};function $s(i,t,l,n,e,c){const _=v("Datepicker"),u=v("CardList");return a(),r("div",ls,[ns,s("form",{onSubmit:t[4]||(t[4]=M(o=>c.getHistory(),["prevent"])),class:"box"},[s("div",as,[s("div",rs,[cs,s("div",ds,[f(_,{class:"input",placeholder:"2021-01-01",modelValue:e.start,"onUpdate:modelValue":t[0]||(t[0]=o=>e.start=o)},null,8,["modelValue"])])]),s("div",_s,[us,s("div",hs,[f(_,{class:"input",placeholder:"2021-01-01",modelValue:e.end,"onUpdate:modelValue":t[1]||(t[1]=o=>e.end=o)},null,8,["modelValue"])])])]),s("div",ms,[s("div",fs,[ps,s("div",ys,[s("div",gs,[p(s("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.limit=o),id:"limit"},ks,512),[[V,e.limit]])])])]),s("div",ws,[s("label",Ds,[p(s("input",{class:"checkbox",type:"checkbox",id:"chronological","onUpdate:modelValue":t[3]||(t[3]=o=>e.chronological=o),"true-value":"yes","false-value":""},null,512),[[$,e.chronological]]),L(" Chronologically ")])]),s("div",Vs,[s("button",{class:x(`button is-link ${e.isLoading?"is-loading":""}`)}," Search ",2)])])],32),f(u,{results:e.results,loading:e.isLoading,error:e.isError},null,8,["results","loading","error"])])}var Cs=b(is,[["render",$s]]);export{Cs as default};

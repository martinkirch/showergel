import{_ as w,h as l,o as h,c as u,b as s,j as b,w as i,v as _,B as v,n as U,F as P,r as g,t as p,p as C,l as k,i as m}from"./index.49246efe.js";import{n}from"./notifications.b7f906af.js";const y={data(){return{addUsername:"",addPassword:"",addPasswordConfirmation:"",showUserAdd:!1,users:[]}},computed:{addPasswordsMismatch(){return this.addPassword!=this.addPasswordConfirmation}},methods:{getUsers(){l.get("/users").then(this.onResults).catch(n.error_handler)},onResults(o){this.users=o.data.users},resetAdd(){this.showUserAdd=!1,this.addUsername="",this.addPassword="",this.addPasswordConfirmation=""},addUser(){this.addPasswordsMismatch||l.put("/users",{username:this.addUsername,password:this.addPassword}).then(this.resetAdd).then(this.getUsers).catch(n.error_handler)},changePassword(o){let e=prompt(`Please enter a new pass phrase for ${o}`);if(e){let c=prompt(`Please confirm ${o}'s new pass phrase`);c&&(c==e?l.post(`/users/${o}`,{password:e}).then(n.success_handler("Pass phrase updated")).catch(n.error_handler):n.error("Pass phrases don't match !"))}},deleteUser(o){confirm(`Really remove ${o}'s account ? All related data will be removed too.`)&&l.delete("/users/"+o).then(this.getUsers).catch(n.error_handler)}},mounted(){this.getUsers()}},a=o=>(C("data-v-c37bdd46"),o=o(),k(),o),A={id:"playout_history",class:"content"},S=a(()=>s("h1",null,"Users",-1)),x=a(()=>s("p",null,[m(" From here you can edit usernames and passwords that will be allowed to stream, if "),s("code",null,"harbor"),m(" authentication "),s("a",{href:"https://showergel.readthedocs.io/en/latest/liquidsoap.html#authenticating-users-on-harbor",target:"_blank"}," is set up "),m(". ")],-1)),M=a(()=>s("div",{class:"modal-background"},null,-1)),V={class:"modal-card"},B={class:"modal-card-head"},D=a(()=>s("p",{class:"modal-card-title"},"Create user account",-1)),I={class:"modal-card-body"},R=a(()=>s("p",null," Avoid special characters (even spaces) in usernames. ",-1)),F={class:"field"},L=a(()=>s("label",{class:"label",for:"username"},"Username",-1)),N={class:"control"},T={class:"field"},j=a(()=>s("label",{class:"label",for:"password"},"Pass phrase",-1)),q={class:"control"},z={class:"field"},E=a(()=>s("label",{class:"label",for:"password_confirmation"},"Confirm pass phrase",-1)),G={class:"control"},H={class:"help is-danger"},J={class:"modal-card-foot"},K=a(()=>s("button",{class:"button is-success",type:"submit",form:"addUser"},"Create account",-1)),O={class:"table-container"},Q={class:"table is-striped"},W=a(()=>s("thead",null,[s("tr",null,[s("th",null,"Username"),s("th",null,"Created"),s("th",null,"Modified"),s("th",null,"Actions")])],-1)),X=["onClick"],Y=a(()=>s("i",{class:"mdi mdi-lock-reset"},null,-1)),Z=[Y],$=["onClick"],ss=a(()=>s("i",{class:"mdi mdi-account-off"},null,-1)),es=[ss];function ts(o,e,c,os,d,r){return h(),u("div",A,[S,x,s("button",{class:"button block is-primary is-rounded",onClick:e[0]||(e[0]=t=>d.showUserAdd=!0)},"Add"),s("div",{class:U(["modal",{"is-active":d.showUserAdd}])},[M,s("div",V,[s("header",B,[D,s("button",{class:"delete","aria-label":"close",onClick:e[1]||(e[1]=t=>r.resetAdd())})]),s("section",I,[s("form",{onSubmit:e[5]||(e[5]=b(t=>r.addUser(),["prevent"])),class:"box",id:"addUser"},[R,s("div",F,[L,s("div",N,[i(s("input",{class:"input",id:"username","onUpdate:modelValue":e[2]||(e[2]=t=>d.addUsername=t)},null,512),[[_,d.addUsername]])])]),s("div",T,[j,s("div",q,[i(s("input",{class:"input",type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=t=>d.addPassword=t)},null,512),[[_,d.addPassword]])])]),s("div",z,[E,s("div",G,[i(s("input",{class:"input",type:"password",id:"password_confirmation","onUpdate:modelValue":e[4]||(e[4]=t=>d.addPasswordConfirmation=t)},null,512),[[_,d.addPasswordConfirmation]])]),i(s("p",H," Pass phrases don't match ",512),[[v,r.addPasswordsMismatch]])])],32)]),s("footer",J,[K,s("button",{class:"button",onClick:e[6]||(e[6]=t=>r.resetAdd())},"Cancel")])])],2),s("div",O,[s("table",Q,[W,s("tbody",null,[(h(!0),u(P,null,g(d.users,t=>(h(),u("tr",{key:t.username},[s("td",null,p(t.username),1),s("td",null,p(new Date(t.created_at).toLocaleString()),1),s("td",null,p(new Date(t.modified_at).toLocaleString()),1),s("td",null,[s("button",{class:"button is-warning icon",onClick:f=>r.changePassword(t.username),title:"Change pass phrase"},Z,8,X),s("button",{class:"button is-danger icon",onClick:f=>r.deleteUser(t.username),title:"Remove user account"},es,8,$)])]))),128))])])])])}var rs=w(y,[["render",ts],["__scopeId","data-v-c37bdd46"]]);export{rs as default};

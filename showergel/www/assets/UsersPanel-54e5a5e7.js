import{_ as S,r as d,c as x,f as A,o as v,a as f,d as s,k as M,w as u,v as b,m as V,n as D,F as I,e as B,l as _,t as w,p as F,q as L,j as g}from"./index-5b2b3b07.js";import{n}from"./notifications-77da6d3c.js";const a=r=>(F("data-v-d9d0e0d9"),r=r(),L(),r),q={id:"playout_history",class:"content"},N=a(()=>s("h1",null,"Users",-1)),R=a(()=>s("p",null,[g(" From here you can edit usernames and passwords that will be allowed to stream, if "),s("code",null,"harbor"),g(" authentication "),s("a",{href:"https://showergel.readthedocs.io/en/latest/liquidsoap.html#authenticating-users-on-harbor",target:"_blank"}," is set up "),g(". ")],-1)),T=a(()=>s("div",{class:"modal-background"},null,-1)),j={class:"modal-card"},z={class:"modal-card-head"},E=a(()=>s("p",{class:"modal-card-title"},"Create user account",-1)),G={class:"modal-card-body"},H=a(()=>s("p",null," Avoid special characters (even spaces) in usernames. ",-1)),J={class:"field"},K=a(()=>s("label",{class:"label",for:"username"},"Username",-1)),O={class:"control"},Q={class:"field"},W=a(()=>s("label",{class:"label",for:"password"},"Pass phrase",-1)),X={class:"control"},Y={class:"field"},Z=a(()=>s("label",{class:"label",for:"password_confirmation"},"Confirm pass phrase",-1)),ss={class:"control"},es={class:"help is-danger"},ts={class:"modal-card-foot"},as=a(()=>s("button",{class:"button is-success",type:"submit",form:"addUser"},"Create account",-1)),os={class:"table-container"},ns={class:"table is-striped"},ls=a(()=>s("thead",null,[s("tr",null,[s("th",null,"Username"),s("th",null,"Created"),s("th",null,"Modified"),s("th",null,"Actions")])],-1)),ds=["onClick"],rs=a(()=>s("i",{class:"mdi mdi-lock-reset"},null,-1)),is=[rs],cs=["onClick"],us=a(()=>s("i",{class:"mdi mdi-account-off"},null,-1)),_s=[us],ps={__name:"UsersPanel",setup(r){const i=d(""),l=d(""),c=d(""),p=d(!1),U=d([]),k=x(()=>l.value==c.value);function h(){_.get("/users").then(o=>U.value=o.data.users).catch(n.error_handler)}A(()=>h());function m(){p.value=!1,i.value="",l.value="",c.value=""}function C(){k.value&&_.put("/users",{username:i.value,password:l.value}).then(m).then(h).catch(n.error_handler)}function y(o){let t=prompt(`Please enter a new pass phrase for ${o}`);if(t){let e=prompt(`Please confirm ${o}'s new pass phrase`);e&&(e==t?_.post(`/users/${o}`,{password:t}).then(n.success_handler("Pass phrase updated")).catch(n.error_handler):n.error("Pass phrases don't match !"))}}function P(o){confirm(`Really remove ${o}'s account ? All related data will be removed too.`)&&_.delete("/users/"+o).then(h).catch(n.error_handler)}return(o,t)=>(v(),f("div",q,[N,R,s("button",{class:"button block is-primary is-rounded",onClick:t[0]||(t[0]=e=>p.value=!0)},"Add"),s("div",{class:D(["modal",{"is-active":p.value}])},[T,s("div",j,[s("header",z,[E,s("button",{class:"delete","aria-label":"close",onClick:t[1]||(t[1]=e=>m())})]),s("section",G,[s("form",{onSubmit:t[5]||(t[5]=M(e=>C(),["prevent"])),class:"box",id:"addUser"},[H,s("div",J,[K,s("div",O,[u(s("input",{class:"input",id:"username","onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e)},null,512),[[b,i.value]])])]),s("div",Q,[W,s("div",X,[u(s("input",{class:"input",type:"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>l.value=e)},null,512),[[b,l.value]])])]),s("div",Y,[Z,s("div",ss,[u(s("input",{class:"input",type:"password",id:"password_confirmation","onUpdate:modelValue":t[4]||(t[4]=e=>c.value=e)},null,512),[[b,c.value]])]),u(s("p",es," Pass phrases don't match ",512),[[V,!k.value]])])],32)]),s("footer",ts,[as,s("button",{class:"button",onClick:t[6]||(t[6]=e=>m())},"Cancel")])])],2),s("div",os,[s("table",ns,[ls,s("tbody",null,[(v(!0),f(I,null,B(U.value,e=>(v(),f("tr",{key:e.username},[s("td",null,w(e.username),1),s("td",null,w(new Date(e.created_at).toLocaleString()),1),s("td",null,w(new Date(e.modified_at).toLocaleString()),1),s("td",null,[s("button",{class:"button is-warning icon",onClick:$=>y(e.username),title:"Change pass phrase"},is,8,ds),s("button",{class:"button is-danger icon",onClick:$=>P(e.username),title:"Remove user account"},_s,8,cs)])]))),128))])])])]))}},vs=S(ps,[["__scopeId","data-v-d9d0e0d9"]]);export{vs as default};
